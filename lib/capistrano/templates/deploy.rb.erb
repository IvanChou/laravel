# config valid only for current version of Capistrano
lock '<%= Capistrano::VERSION %>'

set :application, 'my_app_name'
set :repo_url, 'git@example.com:me/my_repo.git'

# Default branch is :master
# ask :branch, `git rev-parse --abbrev-ref HEAD`.chomp

# Default deploy_to directory is /var/www/my_app_name
# set :deploy_to, '/var/www/my_app_name'

# Default value for :scm is :git
# set :scm, :git

# Default value for :format is :pretty
# set :format, :pretty

# Default value for :log_level is :debug
# set :log_level, :debug

# Default value for :pty is false
# set :pty, false

# Default value for :linked_files is []
set :linked_files, ['.env']

# Default value for linked_dirs is []
# set :linked_dirs, []

# Default value for keep_releases is 5
set :keep_releases, 10

# Default value for php_fpm is php5-fpm
set :php_fpm, 'php7.0-fpm'

# Which roles to execute commands on.
set :laravel_roles, :app
set :laravel_migrate_roles, :db

# Default value for :laravel_version is 5.1
set :laravel_version, 5.2

# If using Laravel 5+, a dotenv file is used for environment configuration.
# This variable uploads the given file from local to servers, default: './.env.example'
# set :laravel_dotenv_file, './.env.example'

# Default value for :laravel_server_user is true
# set :laravel_server_user, 'www-data'

# Default value for :enable_phplint is false
# set :enable_phplint, false

# Default value for :packagist_repo is empty
# set :packagist_repo, 'https://packagist.phpcomposer.com'

# See more configuration at https://github.com/capistrano/laravel.

namespace :deploy do
  after 'deploy:updated', 'laravel:migrate_db'
  after 'deploy:updated', 'laravel:optimize_config'
  after 'deploy:updated', 'laravel:optimize_route'
  after :finishing, 'php_fpm:reload'
end
